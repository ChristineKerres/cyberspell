<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>soft encyclopedia</title>
    <script>
      // Entferne die Slugs aus der URL beim Laden der Seite
      if (window.location.pathname !== "/") {
        var newURL =
          window.location.protocol + "//" + window.location.host + "/";
        window.history.replaceState({}, document.title, newURL);
      }
    </script>

    <style>
      /* Deaktiviere die Textauswahl für das gesamte Dokument */
      body {
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
        user-select: none; /* Standard */
      }

      * {
        font: 18px Hershey;
      }

      @font-face {
        font-family: Hershey Bold;
        src: url("https://cdn.glitch.global/3c1c876b-20ac-4c1f-8b76-a7d7cbf2aa45/Hershey-Noailles-Times-Duplex-Italic-Bold.otf?v=1718549369040");
      }

      @font-face {
        font-family: Hershley Light;
        src: url("https://cdn.glitch.global/3c1c876b-20ac-4c1f-8b76-a7d7cbf2aa45/Hershey-Noailles-Times-Duplex-Italic-Light.otf?v=1718549369458");
      }

      .line-number {
        font: 18px Hershey Bold;
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
        user-select: none; /* Standard */
      }

      #connectionCanvas {
        color: pink;
      }

      .first-button {
        background-color: transparent;
        border: none;
        vertical-align: super;

        position: absolute;
        transition: filter 0.3s ease;
        filter: blur(0.1px);
        color: black;
        font-size: 24pt;
      }

      .first-button:hover {
        font-size: 18pt;
      }

      .first-button:before {
        perspective: 50px;
        perspective-origin: 45% 80%;
      }

      .first-button::after {
        content: "";
        font-size: 14pt;
        color: rgb(0, 0, 0);
        rotate: 180deg;
        top: -1px;
        right: 0;
        bottom: 10px;
        left: 0;
        transform: scaleY(0.9) rotateX(0deg);
        transform-origin: 50% 90%;
        transform: skew(30deg, 0deg) scale(1, 1.2);
        opacity: 0;
        transition: opacity 0.3s ease, filter 0.3s ease;
      }

      .first-button::after {
        content: "࿀";
        position: absolute;
      }

      .first-button:hover::after {
        opacity: 0.3;
        filter: blur(0.1px);
      }

      canvas {
        position: absolute;
        top: 0;
        left: 0;
        pointer-events: none;
      }

      .info,
      .de {
        display: inline-block;
        position: relative;
        font-size: 15pt;
        font: 18px Hershey Futura Regular;
        cursor: help;
        color: black;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-underline-offset: 4px;
      }

      @font-face {
        font-family: Hershey Futura Regular;
        src: url("https://cdn.glitch.global/3c1c876b-20ac-4c1f-8b76-a7d7cbf2aa45/Hershey-Noailles-Futura-Duplex-Regular.otf?v=1718549356950");
      }

      #infotext {
        font: 18px Hershey Futura Regular;
      }

      #copyButton,
      #langToggle {
        font: 18px Hershey Futura Regular;
        color: black;
        position: absolute !important;
        filter: blur(0.1px);
        vertical-align: super;
        position: absolute;
        transition: filter 0.3s ease;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-underline-offset: 4px;
      }
      #copyButton::before,
      #langToggle::before {
        perspective: 50px;
        perspective-origin: 45% 80%;
      }

      #copyButton::after,
      #langToggle::after {
        content: "";
        position: absolute;
        color: rgb(0, 0, 0);
        rotate: 180deg;
        top: -13px;
        right: 0;
        bottom: 0px;
        left: 0;
        transform: scaleY(0.9) rotateX(0deg);
        transform-origin: 50% 90%;
        transform: skew(30deg, 0deg) scale(1, 1.2);
        opacity: 0;
        transition: opacity 0.3s ease, filter 0.3s ease;
      }
      #copyButton:hover::after,
      #langToggle:hover::after {
        opacity: 0.3;
      }
      #copyButton:hover,
      #langToggle:hover {
        font-style: italic;
        transition: transform 0.5s ease;
        text-shadow: 0 0 6px black;
      }

      #confirmationMessage {
        text-decoration: none;
      }

      sup {
        font: 14px Hershey Futura Regular;
        position: relative;
        vertical-align: baseline;
        top: -0.2em;
      }

      .source {
        font: 16px Hershey Futura Regular;
        font-style: oblique;
      }

      .hidden {
        display: none;
      }

      #addition {
        font: 19px Hershley Light;
        font-style: oblique;
        transition: margin-left 0.5s ease;
        padding-left: 60px;
      }

      .addition {
        font: 19px Hershley Light;
        font-style: oblique;
        transition: margin-left 0.5s ease;
        padding-left: 60px;
      }

      .animate-move {
        transition: margin-left 0.5s ease;
      }

      .softtoggle,
      .hypertexttoggle,
      .softtwotoggle,
      .Guintoggle,
      .urltoggle {
        font: 19px Hershey Futura Regular;
        cursor: pointer;
      }

      .softtoggle:hover,
      .hypertexttoggle:hover,
      .softtwotoggle:hover,
      .Guintoggle:hover,
      .urltoggle:hover {
        font: 19px Hershley Light;
        cursor: pointer;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-underline-offset: 3px;
      }
    </style>
  </head>

  <body>
    <div id="copy">
      <a id="copyButton" onclick="copyURLToClipboard(); return false;">
        copy url
      </a>
      <div
        id="confirmationMessage"
        class="confirmation-animation"
        style="display: none"
      >
        copied to the clipboard
      </div>
    </div>


    <canvas id="connectionCanvas"></canvas>

    <script>
  // Sprachsteuerung hinzufügen
  const startButton = document.createElement("button");
  startButton.textContent = "Spracherkennung starten";
  document.body.appendChild(startButton);
  const output = document.createElement("div");
  output.textContent = "Sprich etwas in das Mikrofon!";
  document.body.appendChild(output);
  const loading = document.createElement("div");
  loading.textContent = "Lädt...";
  loading.style.display = "none";
  document.body.appendChild(loading);

  let recognition;

  if (!("webkitSpeechRecognition" in window)) {
    output.textContent = "Spracherkennung wird von diesem Browser nicht unterstützt.";
    startButton.disabled = true;
  } else {
    recognition = new webkitSpeechRecognition();
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = "de-DE";

    recognition.onstart = function () {
      loading.style.display = "block";
      output.textContent = "Spracherkennung läuft...";
    };

    recognition.onresult = function (event) {
  const transcript = event.results[0][0].transcript;
  output.textContent = "Erkannter Text: " + transcript;
  loading.style.display = "none";

  // Vor der Verarbeitung des neuen Slugs die alten Slugs zurücksetzen
  fetch("/api/reset-slugs", { method: "GET" });

  // Hier wird kein Vergleich durchgeführt, sondern einfach ein Button-Click simuliert
  // und der Slug an die Anzeige-Seite übergeben
  const buttons = document.querySelectorAll("button");
  buttons.forEach((button) => {
    const slug = button.getAttribute("data-slug");
    
    // Simuliere den Klick auf einen Button, um den Slug zu übergeben
    if (transcript) {
      fetch("/api/add-slug", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ slug })
      })
      .then(response => {
        
      });
    }
  });
};

    recognition.onerror = function (event) {
      output.textContent = "Fehler bei der Spracherkennung: " + event.error;
      loading.style.display = "none";
    };

    recognition.onend = function () {
      loading.style.display = "none";
    };

    startButton.addEventListener("click", function () {
      output.textContent = "Spracherkennung läuft...";
      recognition.start();
    });
  }
</script>

  </body>
</html>
